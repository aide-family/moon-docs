"use strict";(self.webpackChunkmoon_docs=self.webpackChunkmoon_docs||[]).push([[2470],{6262:(n,s)=>{s.A=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}},260:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>q,data:()=>h});var t=a(641);const e=(0,t.Fv)('<div class="hint-container tip"><p class="hint-container-title">提示</p><p>你可以使用如下语法完成告警模板，高度自定义你的告警内容。</p></div><h2 id="模板语法" tabindex="-1"><a class="header-anchor" href="#模板语法"><span>模板语法</span></a></h2><div class="language-tpl line-numbers-mode" data-ext="tpl" data-title="tpl"><pre class="language-tpl"><code>告警状态: {{ .Status }}\n告警标签: {{ .Labels }}\n\t机器实例: {{ .Labels.instance }}\n\t告警规则名称: {{ .Labels.alertname }}\n告警内容: {{ .Annotations }}\n\t告警描述: {{ .Annotations.summary }}\n\t告警详情: {{ .Annotations.description }}\n告警时间: {{ .StartsAt }}\n恢复时间: {{ .EndsAt }}\n链接地址: {{ .GeneratorURL }}\n告警指纹: {{ .Fingerprint }}\n当前值: {{ .Value }}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',3),i={class:"hint-container note"},p=(0,t.Lk)("p",{class:"hint-container-title"},"注",-1),o=(0,t.Lk)("code",null,"Labels",-1),l=(0,t.Lk)("code",null,"Annotations",-1),u=(0,t.Lk)("code",null,"map[string]string",-1),c=(0,t.Lk)("code",null,".Labels.xxx",-1),r=(0,t.Lk)("code",null,".Annotations.xxx",-1),d=(0,t.Lk)("code",null,"{{ .Labels }}",-1),k=(0,t.Lk)("code",null,"{{ .Annotations }}",-1),v=(0,t.Lk)("code",null,"json",-1),m={href:"https://golang.org/pkg/text/template/",target:"_blank",rel:"noopener noreferrer"},g=(0,t.Fv)('<h2 id="模板原始数据" tabindex="-1"><a class="header-anchor" href="#模板原始数据"><span>模板原始数据</span></a></h2><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code>AlertBo <span class="token keyword">struct</span> <span class="token punctuation">{</span>\n\t\tStatus       <span class="token builtin">string</span>                <span class="token string">`json:&quot;status&quot;`</span>\n\t\tLabels       <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>     <span class="token string">`json:&quot;labels&quot;`</span>\n\t\tAnnotations  <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>     <span class="token string">`json:&quot;annotations&quot;`</span>\n\t\tStartsAt     <span class="token builtin">string</span>                <span class="token string">`json:&quot;startsAt&quot;`</span>\n\t\tEndsAt       <span class="token builtin">string</span>                <span class="token string">`json:&quot;endsAt&quot;`</span>\n\t\tGeneratorURL <span class="token builtin">string</span>                <span class="token string">`json:&quot;generatorURL&quot;`</span>\n\t\tFingerprint  <span class="token builtin">string</span>                <span class="token string">`json:&quot;fingerprint&quot;`</span>\n\t\tValue        <span class="token builtin">float64</span>               <span class="token string">`json:&quot;value&quot;`</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="系统内置函数" tabindex="-1"><a class="header-anchor" href="#系统内置函数"><span>系统内置函数</span></a></h2><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">templateFuncMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> template<span class="token punctuation">.</span>FuncMap <span class="token punctuation">{</span>\n\t<span class="token keyword">return</span> template<span class="token punctuation">.</span>FuncMap<span class="token punctuation">{</span>\n\t\t<span class="token string">&quot;now&quot;</span><span class="token punctuation">:</span>        time<span class="token punctuation">.</span>Now<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;hasPrefix&quot;</span><span class="token punctuation">:</span>  strings<span class="token punctuation">.</span>HasPrefix<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;hasSuffix&quot;</span><span class="token punctuation">:</span>  strings<span class="token punctuation">.</span>HasSuffix<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;contains&quot;</span><span class="token punctuation">:</span>   strings<span class="token punctuation">.</span>Contains<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;TrimSpace&quot;</span><span class="token punctuation">:</span>  strings<span class="token punctuation">.</span>TrimSpace<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;trimPrefix&quot;</span><span class="token punctuation">:</span> strings<span class="token punctuation">.</span>TrimPrefix<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;trimSuffix&quot;</span><span class="token punctuation">:</span> strings<span class="token punctuation">.</span>TrimSuffix<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;toUpper&quot;</span><span class="token punctuation">:</span>    strings<span class="token punctuation">.</span>ToUpper<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;toLower&quot;</span><span class="token punctuation">:</span>    strings<span class="token punctuation">.</span>ToLower<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;replace&quot;</span><span class="token punctuation">:</span>    strings<span class="token punctuation">.</span>Replace<span class="token punctuation">,</span>\n\t\t<span class="token string">&quot;split&quot;</span><span class="token punctuation">:</span>      strings<span class="token punctuation">.</span>Split<span class="token punctuation">,</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="内置函数使用示例" tabindex="-1"><a class="header-anchor" href="#内置函数使用示例"><span>内置函数使用示例</span></a></h3><ul><li>模板</li></ul><div class="language-tpl line-numbers-mode" data-ext="tpl" data-title="tpl"><pre class="language-tpl"><code>当前时间: {{ now.Format &quot;2006-01-02 15:04:05&quot; }}\n是否告警: {{ if contains .Status &quot;firing&quot; }}告警了{{ else }}恢复了{{ end }}\nIP:{{ range split .Labels.ip &quot;.&quot; }}\n an ip {{ . }}\n{{- end }}\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>模板数据</li></ul><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code>data <span class="token operator">:=</span> <span class="token operator">&amp;</span>AlertBo<span class="token punctuation">{</span>\n    Status<span class="token punctuation">:</span>       <span class="token string">&quot;firing&quot;</span><span class="token punctuation">,</span>\n    Labels<span class="token punctuation">:</span>       <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>\n        <span class="token string">&quot;__name__&quot;</span><span class="token punctuation">:</span>       <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;__alert_id__&quot;</span><span class="token punctuation">:</span>   <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;__group_name__&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;__group_id__&quot;</span><span class="token punctuation">:</span>   <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;__level_id__&quot;</span><span class="token punctuation">:</span>   <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;instance&quot;</span><span class="token punctuation">:</span>       <span class="token string">&quot;test-instance&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;alertname&quot;</span><span class="token punctuation">:</span>      <span class="token string">&quot;test-alert&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;ip&quot;</span><span class="token punctuation">:</span>             <span class="token string">&quot;192.168.1.100&quot;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    Annotations<span class="token punctuation">:</span>  <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>\n        <span class="token string">&quot;summary&quot;</span><span class="token punctuation">:</span>     <span class="token string">&quot;test summary&quot;</span><span class="token punctuation">,</span>\n        <span class="token string">&quot;description&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;test description&quot;</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    StartsAt<span class="token punctuation">:</span>     time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>RFC3339<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    EndsAt<span class="token punctuation">:</span>       time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Hour<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>RFC3339<span class="token punctuation">)</span><span class="token punctuation">,</span>\n    GeneratorURL<span class="token punctuation">:</span> <span class="token string">&quot;https://prometheus.aide-cloud.cn/#/home&quot;</span><span class="token punctuation">,</span>\n    Fingerprint<span class="token punctuation">:</span>  hash<span class="token punctuation">.</span><span class="token function">MD5</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    Value<span class="token punctuation">:</span>        <span class="token number">100.0011</span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>结果</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>当前时间: <span class="token number">2024</span>-04-26 <span class="token number">17</span>:39:00\n是否告警: 告警了\nIP:\n    an <span class="token function">ip</span> <span class="token number">192</span>\n    an <span class="token function">ip</span> <span class="token number">168</span>\n    an <span class="token function">ip</span> <span class="token number">1</span>\n    an <span class="token function">ip</span> <span class="token number">100</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">注</p><pre><code>其他用法可自行尝试\n</code></pre></div>',12),b={},q=(0,a(6262).A)(b,[["render",function(n,s){const a=(0,t.g2)("ExternalLinkIcon");return(0,t.uX)(),(0,t.CE)("div",null,[e,(0,t.Lk)("div",i,[p,(0,t.Lk)("p",null,[(0,t.eW)("模板支持的变量，如下，其中"),o,(0,t.eW)("和"),l,(0,t.eW)("都是"),u,(0,t.eW)("类型， 所以可以通过"),c,(0,t.eW)("或者"),r,(0,t.eW)("来获取对应的值，具体有哪些变量，可以查看具体指标的原始数据， 例如："),d,(0,t.eW)(", "),k,(0,t.eW)(", 此用法会返回原始数据"),v,(0,t.eW)("格式. 关于Go语言模板语法，可以参考："),(0,t.Lk)("a",m,[(0,t.eW)("Go语言模板语法"),(0,t.bF)(a)])])]),g])}]]),h=JSON.parse('{"path":"/i18n/zh/guide/user/monitor/hook-template.html","title":"告警模板","lang":"zh-CN","frontmatter":{"title":"告警模板","order":2,"description":"提示 你可以使用如下语法完成告警模板，高度自定义你的告警内容。 模板语法 注 模板支持的变量，如下，其中Labels和Annotations都是map[string]string类型， 所以可以通过.Labels.xxx或者.Annotations.xxx来获取对应的值，具体有哪些变量，可以查看具体指标的原始数据， 例如：{{ .Labels }}, ...","head":[["meta",{"property":"og:url","content":"https://aide-family.github.io/i18n/zh/guide/user/monitor/hook-template.html"}],["meta",{"property":"og:site_name","content":"Moon监控使用文档"}],["meta",{"property":"og:title","content":"告警模板"}],["meta",{"property":"og:description","content":"提示 你可以使用如下语法完成告警模板，高度自定义你的告警内容。 模板语法 注 模板支持的变量，如下，其中Labels和Annotations都是map[string]string类型， 所以可以通过.Labels.xxx或者.Annotations.xxx来获取对应的值，具体有哪些变量，可以查看具体指标的原始数据， 例如：{{ .Labels }}, ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-26T09:44:51.000Z"}],["meta",{"property":"article:author","content":"梧桐"}],["meta",{"property":"article:modified_time","content":"2024-04-26T09:44:51.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"告警模板\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-26T09:44:51.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"梧桐\\",\\"url\\":\\"https://github.com/aide-cloud\\",\\"email\\":\\"aidecloud@163.com\\"}]}"]]},"headers":[{"level":2,"title":"模板语法","slug":"模板语法","link":"#模板语法","children":[]},{"level":2,"title":"模板原始数据","slug":"模板原始数据","link":"#模板原始数据","children":[]},{"level":2,"title":"系统内置函数","slug":"系统内置函数","link":"#系统内置函数","children":[{"level":3,"title":"内置函数使用示例","slug":"内置函数使用示例","link":"#内置函数使用示例","children":[]}]}],"git":{"createdTime":1714123439000,"updatedTime":1714124691000,"contributors":[{"name":"梧桐","email":"1058165620@qq.com","commits":3}]},"readingTime":{"minutes":1.43,"words":429},"filePathRelative":"i18n/zh/guide/user/monitor/hook-template.md","localizedDate":"2024年4月26日","autoDesc":true}')}}]);