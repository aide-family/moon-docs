"use strict";(self.webpackChunkmoon_docs=self.webpackChunkmoon_docs||[]).push([[6712],{6262:(n,s)=>{s.A=(n,s)=>{const a=n.__vccOpts||n;for(const[n,t]of s)a[n]=t;return a}},25:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>l,data:()=>u});var t=a(641);const e=(0,t.Lk)("h2",{id:"自定义数据源",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#自定义数据源"},[(0,t.Lk)("span",null,"自定义数据源")])],-1),k=(0,t.Lk)("div",{class:"hint-container tip"},[(0,t.Lk)("p",{class:"hint-container-title"},"提示"),(0,t.Lk)("p",null,"你可以为任何数据源实现如下的数据源接口，即可加入moon系统， 作为系统的告警数据源")],-1),o=(0,t.Lk)("div",{class:"language-go line-numbers-mode","data-ext":"go","data-title":"go"},[(0,t.Lk)("pre",{class:"language-go"},[(0,t.Lk)("code",null,[(0,t.Lk)("span",{class:"token keyword"},"type"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token comment"},"// Metric 查询到的数据labels"),(0,t.eW)("\n\tMetric "),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// Result 查询到的数据"),(0,t.eW)("\n\tResult "),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Metric 查询到的数据labels"),(0,t.eW)("\n\t\tMetric Metric  "),(0,t.Lk)("span",{class:"token string"},'`json:"metric"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Ts 时间戳"),(0,t.eW)("\n\t\tTs     "),(0,t.Lk)("span",{class:"token builtin"},"float64"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"ts"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Value 值"),(0,t.eW)("\n\t\tValue  "),(0,t.Lk)("span",{class:"token builtin"},"float64"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"value"`'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// Data 查询到的数据"),(0,t.eW)("\n\tData "),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// ResultType 查询到的数据类型"),(0,t.eW)("\n\t\tResultType "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)("    "),(0,t.Lk)("span",{class:"token string"},'`json:"resultType"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Result 查询到的数据集合"),(0,t.eW)("\n\t\tResult     "),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("Result "),(0,t.Lk)("span",{class:"token string"},'`json:"result"`'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// QueryResponse 查询结果"),(0,t.eW)("\n\tQueryResponse "),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Status 状态"),(0,t.eW)("\n\t\tStatus    "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"status"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Data 数据"),(0,t.eW)("\n\t\tData      "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("Data  "),(0,t.Lk)("span",{class:"token string"},'`json:"data"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// ErrorType 错误类型"),(0,t.eW)("\n\t\tErrorType "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"errorType"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Error 错误信息"),(0,t.eW)("\n\t\tError     "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"error"`'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// MetricDetail 查询到的数据详情， 用与元数据构建"),(0,t.eW)("\n\tMetricDetail "),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Name 指标名称"),(0,t.eW)("\n\t\tName   "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"name"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Help 帮助信息"),(0,t.eW)("\n\t\tHelp   "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"help"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Type 类型"),(0,t.eW)("\n\t\tType   "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"type"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Labels 标签集合"),(0,t.eW)("\n\t\tLabels Labels "),(0,t.Lk)("span",{class:"token string"},'`json:"labels"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Unit 指标单位"),(0,t.eW)("\n\t\tUnit   "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'`json:"unit"`'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// Metadata 查询到的元数据详情"),(0,t.eW)("\n\tMetadata "),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Metric 元数据列表"),(0,t.eW)("\n\t\tMetric "),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("MetricDetail "),(0,t.Lk)("span",{class:"token string"},'`json:"metric"`'),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Unix 查询时间戳"),(0,t.eW)("\n\t\tUnix   "),(0,t.Lk)("span",{class:"token builtin"},"int64"),(0,t.eW)("           "),(0,t.Lk)("span",{class:"token string"},'`json:"unix"`'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// Datasource 数据源完整接口定义"),(0,t.eW)("\n\tDatasource "),(0,t.Lk)("span",{class:"token keyword"},"interface"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Query 查询数据"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"Query"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Context"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" expr "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" duration "),(0,t.Lk)("span",{class:"token builtin"},"int64"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("QueryResponse"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// Metadata 查询元数据"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"Metadata"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Context"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("Metadata"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// GetCategory 获取数据源类型"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"GetCategory"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(" Category\n        "),(0,t.Lk)("span",{class:"token comment"},"// GetEndpoint 获取数据源http地址"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"GetEndpoint"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token comment"},"// GetBasicAuth 获取数据源http认证信息, 可选"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"GetBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("BasicAuth\n        "),(0,t.Lk)("span",{class:"token comment"},"// WithBasicAuth 设置数据源http认证信息, 可选"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"WithBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("basicAuth "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("BasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(" Datasource\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// Category 数据源类型, 定义类型如下"),(0,t.eW)("\n\tCategory "),(0,t.Lk)("span",{class:"token builtin"},"int32"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token comment"},"// Prometheus Prometheus数据源类型，默认为该类型"),(0,t.eW)("\n\tPrometheus Category "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"iota"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token comment"},"// VictoriaMetrics VictoriaMetrics数据源类型"),(0,t.eW)("\n\tVictoriaMetrics\n    "),(0,t.Lk)("span",{class:"token comment"},"// Elasticsearch Elasticsearch数据源类型"),(0,t.eW)("\n\tElasticsearch\n    "),(0,t.Lk)("span",{class:"token comment"},"// Influxdb Influxdb数据源类型"),(0,t.eW)("\n\tInfluxdb\n    "),(0,t.Lk)("span",{class:"token comment"},"// Clickhouse Clickhouse数据源类型"),(0,t.eW)("\n\tClickhouse\n    "),(0,t.Lk)("span",{class:"token comment"},"// Loki Loki数据源类型"),(0,t.eW)("\n\tLoki\n"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n")])]),(0,t.Lk)("div",{class:"line-numbers","aria-hidden":"true"},[(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"})])],-1),c=(0,t.Lk)("div",{class:"language-go line-numbers-mode","data-ext":"go","data-title":"go"},[(0,t.Lk)("pre",{class:"language-go"},[(0,t.Lk)("code",null,[(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// prometheusApiV1Query 查询接口"),(0,t.eW)("\n\tprometheusApiV1Query "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"/api/v1/query"'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// prometheusApiV1Metadata 元数据查询接口"),(0,t.eW)("\n\tprometheusApiV1Metadata "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"/api/v1/metadata"'),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// prometheusApiV1Series /api/v1/series"),(0,t.eW)("\n\tprometheusApiV1Series "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"/api/v1/series"'),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// NewPrometheusDatasource 创建 prometheus 数据源"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"NewPrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("opts "),(0,t.Lk)("span",{class:"token operator"},"..."),(0,t.eW)("Option"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(" agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Datasource "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\tp "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tcategory"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Prometheus"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"_"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" opt "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"range"),(0,t.eW)(" opts "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token function"},"opt"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" p\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// PrometheusDatasource 数据源模型定义"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"type"),(0,t.eW)(" PrometheusDatasource "),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 数据源地址"),(0,t.eW)("\n\tendpoint "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 数据源类型"),(0,t.eW)("\n\tcategory agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Category\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 数据源基础认证"),(0,t.eW)("\n\tbasicAuth "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("BasicAuth\n\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 读写锁， 并发安全"),(0,t.eW)("\n\tmut sync"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("RWMutex\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// Metadata 实现数据源元数据获取接口"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"Metadata"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Context"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Metadata"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 判断数据源是否就绪"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"IsReady"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" errors"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"New"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"datasource not ready"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tnow "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" time"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Now"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 获取元数据"),(0,t.eW)("\n\tmetadataInfo"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"metadata"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tmetricNames "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"make"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metadataInfo"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(" metricName "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"range"),(0,t.eW)(" metadataInfo "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tmetricNames "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"append"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricNames"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" metricName"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token comment"},"//metricNames = metricNames[:151]"),(0,t.eW)("\n\tmetrics "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"make"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("MetricDetail"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricNames"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tlock "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"new"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("sync"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("RWMutex"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tbatchNum "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"20"),(0,t.eW)("\n\tnamesLen "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricNames"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\teg "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"new"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("errgroup"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Group"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 因为数据量比较大， 这里并发获取各个metric的元数据， 并且将结果写入到metrics中"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(" i "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(" i "),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)(" namesLen"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(" i "),(0,t.Lk)("span",{class:"token operator"},"+="),(0,t.eW)(" batchNum "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tleft "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" i\n\t\tright "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" left "),(0,t.Lk)("span",{class:"token operator"},"+"),(0,t.eW)(" batchNum\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" right "),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)(" namesLen "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\tright "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" namesLen\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\teg"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Go"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\tseriesInfo"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" seriesErr "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"series"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Background"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" now"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" metricNames"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.eW)("left"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("right"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token operator"},"..."),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" seriesErr "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t\tlog"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Warnw"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"series error"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" seriesErr"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" seriesErr\n\t\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t\t\tmetricsTmp "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"make"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("MetricDetail"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" right"),(0,t.Lk)("span",{class:"token operator"},"-"),(0,t.eW)("left"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(" metricName"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" metricInfos "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"range"),(0,t.eW)(" metadataInfo "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricInfos"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"=="),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"continue"),(0,t.eW)("\n\t\t\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\t\t\tmetricInfo "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" metricInfos"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("\n\t\t\t\titem "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("MetricDetail"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t\t\tType"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("   metricInfo"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetType"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\t\t\tName"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("   metricName"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\t\t\tHelp"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("   metricInfo"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetHelp"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\t\t\tUnit"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("   metricInfo"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetUnit"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\t\t\tLabels"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Labels"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("seriesInfo"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.eW)("metricName"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\t\t\tmetricsTmp "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"append"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricsTmp"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" item"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\t\tlock"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Lock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" lock"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Unlock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\tmetrics "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"append"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metrics"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" metricsTmp"),(0,t.Lk)("span",{class:"token operator"},"..."),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" eg"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Wait"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Metadata"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tMetric"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" metrics"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tUnix"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("   now"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Unix"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// metadata 获取原始数据"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"metadata"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Context"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("MetricInfo"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"IsReady"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" fmt"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Errorf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"datasource not ready"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\thx "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" httpx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"NewHttpX"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\thx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SetHeader"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"Accept"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("          "),(0,t.Lk)("span",{class:"token string"},'"*/*"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"Accept-Language"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"zh-CN,zh;q=0.9"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\thx "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" hx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SetBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Username"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Password"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tgetResponse"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" hx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GETWithContext"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" fmt"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Sprintf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"%s%s"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("endpoint"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" prometheusApiV1Metadata"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" getResponse"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Body"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Close"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"var"),(0,t.eW)(" allResp MetadataResponse\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" json"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"NewDecoder"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("getResponse"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Body"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Decode"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("allResp"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" allResp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetData"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// series 查询时间序列"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"series"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Context"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" t time"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Time"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" metricNames "),(0,t.Lk)("span",{class:"token operator"},"..."),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("MetricLabel"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"IsReady"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" fmt"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Errorf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"datasource not ready"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tnow "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" t\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 获取此格式时间2024-04-21T17:58:55.061Z"),(0,t.eW)("\n\tstart "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" now"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Add"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"-"),(0,t.eW)("time"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Hour "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"24"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Format"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"2006-01-02T15:04:05.000Z"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tend "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" now"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Format"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"2006-01-02T15:04:05.000Z"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\n\tparams "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" httpx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"ParseQuery"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("any"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"start"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" start"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"end"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("   end"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tmetricNameParams "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"make"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricNames"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"_"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" metricName "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"range"),(0,t.eW)(" metricNames "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tmetricNameParams "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"append"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricNameParams"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" httpx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"ParseQuery"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("any"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token string"},'"match[]"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" metricName"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\thx "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" httpx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"NewHttpX"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\thx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SetHeader"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"Accept"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("          "),(0,t.Lk)("span",{class:"token string"},'"*/*"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"Accept-Language"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"zh-CN,zh;q=0.9"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\thx "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" hx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SetBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Username"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Password"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\turl "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" fmt"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Sprintf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"%s%s?%s&%s"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("endpoint"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tprometheusApiV1Series"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tparams"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tstrings"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Join"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("metricNameParams"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"&"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\n\tgetResponse"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" hx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GETWithContext"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" url"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" getResponse"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Body"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Close"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"var"),(0,t.eW)(" allResp MetricSeriesResponse\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" json"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"NewDecoder"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("getResponse"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Body"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Decode"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("allResp"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\tres "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"make"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("MetricLabel"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"_"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" v "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"range"),(0,t.eW)(" allResp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetData"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tmetricName "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" v"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetMetricName"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" metricName "),(0,t.Lk)("span",{class:"token operator"},"=="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'""'),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"continue"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\tres"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.eW)("metricName"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" v\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" res"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// Query 实现数据源查询接口"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"Query"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx context"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Context"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" expr "),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" duration "),(0,t.Lk)("span",{class:"token builtin"},"int64"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("QueryResponse"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"error"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 判断数据源是否就绪"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"IsReady"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" errors"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"New"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"datasource not ready"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tparams "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" httpx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"ParseQuery"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.eW)("any"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"query"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" expr"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"time"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("  duration"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\n\thx "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" httpx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"NewHttpX"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\thx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SetHeader"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"map"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"Accept"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("          "),(0,t.Lk)("span",{class:"token string"},'"*/*"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token string"},'"Accept-Language"'),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"zh-CN,zh;q=0.9"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\thx "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" hx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SetBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Username"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Password"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tgetResponse"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" hx"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GETWithContext"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ctx"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" fmt"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Sprintf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"%s%s?%s"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("endpoint"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" prometheusApiV1Query"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" params"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" getResponse"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Body"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Close"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"var"),(0,t.eW)(" allResp QueryResponse\n\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" json"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"NewDecoder"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("getResponse"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Body"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Decode"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("allResp"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(" err "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" err\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\tdata "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" allResp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetData"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tresult "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"make"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Result"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("data"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetResult"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"_"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" v "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"range"),(0,t.eW)(" data"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetResult"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tvalue "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" v"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetValue"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"len"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("value"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"2"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"continue"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\tts"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" tsAssertOk "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" value"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token number"},"0"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token builtin"},"float64"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("tsAssertOk "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"continue"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\tmetricValue"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" parseErr "),(0,t.Lk)("span",{class:"token operator"},":="),(0,t.eW)(" strconv"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"ParseFloat"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("fmt"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Sprintf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"%v"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" value"),(0,t.Lk)("span",{class:"token punctuation"},"["),(0,t.Lk)("span",{class:"token number"},"1"),(0,t.Lk)("span",{class:"token punctuation"},"]"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"64"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(" parseErr "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\t"),(0,t.Lk)("span",{class:"token keyword"},"continue"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\t\tresult "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"append"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("result"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Result"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\tMetric"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" v"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetMetric"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\tTs"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("     ts"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\tValue"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("  metricValue"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("QueryResponse"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tStatus"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" allResp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetStatus"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tData"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Data"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t\tResultType"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" data"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetResultType"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t\tResult"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("     result"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tErrorType"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)(" allResp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetErrorType"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t\tError"),(0,t.Lk)("span",{class:"token punctuation"},":"),(0,t.eW)("     allResp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetError"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// GetCategory 获取数据源类型"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetCategory"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(" agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Category "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\tp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"RLocker"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"RUnlock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("category\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetEndpoint"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"string"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\tp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"RLocker"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"RUnlock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("endpoint\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("BasicAuth "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\tp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"RLocker"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"RUnlock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"WithBasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("basicAuth "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("BasicAuth"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(" agent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Datasource "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\tp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Lock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"defer"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("mut"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Unlock"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tp"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("basicAuth "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" basicAuth\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" p\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// IsReady 是否准备就绪"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"func"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("p "),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)("PrometheusDatasource"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"IsReady"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token builtin"},"bool"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" p "),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"nil"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&&"),(0,t.eW)(" p"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"GetEndpoint"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"!="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'""'),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n")])]),(0,t.Lk)("div",{class:"line-numbers","aria-hidden":"true"},[(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"})])],-1),p={},l=(0,a(6262).A)(p,[["render",function(n,s){const a=(0,t.g2)("CodeTabs");return(0,t.uX)(),(0,t.CE)("div",null,[e,k,(0,t.bF)(a,{id:"8",data:[{id:"数据源接口定义"},{id:"默认prometheus数据源实现"}],"tab-id":"go"},{title0:(0,t.k6)((({value:n,isActive:s})=>[(0,t.eW)("数据源接口定义")])),title1:(0,t.k6)((({value:n,isActive:s})=>[(0,t.eW)("默认prometheus数据源实现")])),tab0:(0,t.k6)((({value:n,isActive:s})=>[o])),tab1:(0,t.k6)((({value:n,isActive:s})=>[c])),_:1})])}]]),u=JSON.parse('{"path":"/i18n/zh/guide/developer/customer-datasource.html","title":"实现自定义数据源","lang":"zh-CN","frontmatter":{"title":"实现自定义数据源","order":1,"description":"自定义数据源 提示 你可以为任何数据源实现如下的数据源接口，即可加入moon系统， 作为系统的告警数据源","head":[["meta",{"property":"og:url","content":"https://aide-family.github.io/i18n/zh/guide/developer/customer-datasource.html"}],["meta",{"property":"og:site_name","content":"Moon监控使用文档"}],["meta",{"property":"og:title","content":"实现自定义数据源"}],["meta",{"property":"og:description","content":"自定义数据源 提示 你可以为任何数据源实现如下的数据源接口，即可加入moon系统， 作为系统的告警数据源"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-26T07:03:41.000Z"}],["meta",{"property":"article:author","content":"梧桐"}],["meta",{"property":"article:modified_time","content":"2024-04-26T07:03:41.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"实现自定义数据源\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-04-26T07:03:41.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"梧桐\\",\\"url\\":\\"https://github.com/aide-cloud\\",\\"email\\":\\"aidecloud@163.com\\"}]}"]]},"headers":[{"level":2,"title":"自定义数据源","slug":"自定义数据源","link":"#自定义数据源","children":[]}],"git":{"createdTime":1713509209000,"updatedTime":1714115021000,"contributors":[{"name":"梧桐","email":"1058165620@qq.com","commits":2}]},"readingTime":{"minutes":4.35,"words":1305},"filePathRelative":"i18n/zh/guide/developer/customer-datasource.md","localizedDate":"2024年4月19日","autoDesc":true}')}}]);